!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var s in i)("object"==typeof exports?exports:e)[s]=i[s]}}(window,function(){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var l=t[s]={i:s,l:!1,exports:{}};return e[s].call(l.exports,l,l.exports,i),l.l=!0,l.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)i.d(s,l,function(t){return e[t]}.bind(null,l));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/Users/lhd/my/projects/study-notes/components/VirtualSelect/dist",i(i.s=3)}([function(e,t,i){},function(e,t,i){"use strict";var s=i(0);i.n(s).a},,function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-virtual-select",on:{click:function(t){return t.stopPropagation(),e.toggleMenu(t)}}},[i("div",{staticClass:"select-input-box",attrs:{title:e.selectedLabel}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.queryLabel,expression:"queryLabel"}],ref:"input",staticClass:"input",class:{"is-disabled":e.disabled},attrs:{type:"text",readonly:!e.filterable,disabled:e.selectDisabled,placeholder:e.selectedLabel||e.placeholder},domProps:{value:e.queryLabel},on:{focus:e.handleFocus,blur:e.handleBlur,input:[function(t){t.target.composing||(e.queryLabel=t.target.value)},e.debouncedOnInputChange]}}),e._v(" "),i("div",{staticClass:"suffix-arrow",class:{"suffix-arrow-focus":e.visible}}),e._v(" "),e.queryLabel&&e.clearable?i("div",{staticClass:"suffix-clear",on:{click:function(t){return t.stopPropagation(),e.clear(t)}}},[i("div",{staticClass:"circle"})]):e._e()]),e._v(" "),e.visible?i("div",{staticClass:"select-dropdown-box",on:{click:function(e){e.stopPropagation()}}},[i("div",{staticClass:"top-arrow"}),e._v(" "),i("div",{ref:"list-container-ref",staticClass:"list-container",style:{maxHeight:e.visibleNumber*e.itemHeight+12+"px"},on:{scroll:e.onScrollChange}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.allNum>0,expression:"allNum > 0"}],staticClass:"real-height-box",style:{height:e.allNum*e.itemHeight+"px"}},[i("div",{staticClass:"list",style:{transform:e.transformOffset}},e._l(e.filterDataList.slice(e.startIndex,e.endIndex+e.visibleNumber),function(t,s){return i("div",{key:t[e.itemKey]||s,staticClass:"item",class:{"is-selected":e.value===t[e.valueKey]},style:{height:e.itemHeight+"px",lineHeight:e.itemHeight+"px"},attrs:{title:t[e.labelKey]},on:{click:function(i){e.selectItemClick(t,s)}}},[e.$slots.item?e._t("item",null,{item:t,itemHeight:e.itemHeight}):i("span",[e._v(e._s(t[e.labelKey]))])],2)}))]),e._v(" "),e.emptyText&&0===e.allNum?[e.$slots.empty?e._t("empty"):i("p",{staticClass:"empty-text"},[e._v("\n                    "+e._s(e.emptyText)+"\n                ")])]:e._e()],2)]):e._e()])};s._withStripped=!0;var l={name:"VirtualSelect",componentName:"VirtualSelect",props:{name:String,disabled:Boolean,clearable:Boolean,noDataText:String,filterMethod:Function,value:{required:!0},visibleNumber:{type:Number,default:10},itemHeight:{type:Number,default:34},labelKey:{type:String,default:"label"},valueKey:{type:String,default:"value"},itemKey:{type:String,default:"id"},placeholder:{type:String,default:"请选择",required:!1},filterable:{type:Boolean,default:!0},dataList:{type:Array,default:()=>[]}},data:()=>({visible:!1,filterDataList:[],startIndex:0,selectedLabel:"",queryLabel:""}),computed:{allNum(){return this.filterDataList.length},endIndex(){return this.startIndex+this.visibleNumber},halfItemNumber(){return Math.ceil(this.visibleNumber/2)},currentIndex(){const e=this.filterDataList.findIndex(e=>e[this.valueKey]===this.value);return e>-1?e:0},transformOffset(){return`translateY(${this.startIndex*this.itemHeight}px)`},emptyText(){return this.noDataText||"暂无数据"},selectDisabled(){return this.disabled}},watch:{value(){this.setSelected(),this.setStartIndex()},visible(e){e?(this.queryLabel="",this.initFilterDataList(),this.setStartIndex(),setTimeout(()=>{this.setScrollTop()},1)):(this.$refs.input&&this.$refs.input.blur(),this.queryLabel!==this.selectedLabel&&(this.queryLabel=this.selectedLabel)),this.$emit("visible-change",e)},dataList(){this.initFilterDataList()}},methods:{handleFocus(e){this.visible||(this.visible=!0,this.$emit("focus",e))},handleBlur(e){setTimeout(()=>{this.$emit("blur",e)},100)},initFilterDataList(){this.filterDataList=this.dataList},setSelected(){const e=this.filterDataList[this.currentIndex];e&&(this.selectedLabel=e[this.labelKey],this.queryLabel=this.selectedLabel)},getStartIndex(e){return e<this.halfItemNumber*this.itemHeight?0:e/this.itemHeight-this.halfItemNumber>>>0},setStartIndex(){const e=this.currentIndex-this.halfItemNumber;this.startIndex=e<0?0:e},setScrollTop(){const e=this.$refs["list-container-ref"];if(e){const t=(this.startIndex+this.halfItemNumber)*this.itemHeight>>>0;e.scrollTop=t>this.halfItemNumber*this.itemHeight?t:0}},onScrollChange(e){const t=e.target.scrollTop;this.startIndex=this.getStartIndex(t)},handleDataList(){if(this.queryLabel)if("function"==typeof this.filterMethod){const e=this.filterMethod(this.queryLabel);Array.isArray(e)&&(this.filterDataList=e)}else this.filterDataList=this.dataList.filter(e=>String(e[this.labelKey]).includes(this.queryLabel));else this.initFilterDataList()},onInputChange(){this.handleDataList()},toggleMenu(){this.selectDisabled||this.visible||this.$refs&&this.$refs.input&&this.$refs.input.focus()},selectItemClick(e,t){this.selectedLabel=e[this.labelKey],this.$emit("input",e[this.valueKey]),this.$emit("change",e[this.valueKey],e,t),this.visible=!1},clear(){this.selectedLabel="",this.startIndex=0,this.queryLabel="",this.$emit("input","")},close(){this.visible=!1}},created(){this.debouncedOnInputChange=function(e,t){let i=null;return function(...s){i&&(clearTimeout(i),i=null),i=setTimeout(()=>{e.apply(this,s),i=null},t)}}(()=>{this.onInputChange()},300),this.initFilterDataList(),this.setSelected(),document.addEventListener("click",this.close)},beforeDestroy(){document.removeEventListener("click",this.close)}};i(1);var r=function(e,t,i,s,l,r,n,a){var o,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=i,u._compiled=!0),s&&(u.functional=!0),r&&(u._scopeId="data-v-"+r),n?(o=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),l&&l.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},u._ssrRegister=o):l&&(o=a?function(){l.call(this,this.$root.$options.shadowRoot)}:l),o)if(u.functional){u._injectStyles=o;var c=u.render;u.render=function(e,t){return o.call(t),c(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,o):[o]}return{exports:e,options:u}}(l,s,[],!1,null,"4236ed3e",null);r.options.__file="src/VirtualSelect.vue";var n=r.exports;n.install=function(e){e.component(n.name,n)};t.default=n}])});
//# sourceMappingURL=virtualSelect.min.js.map